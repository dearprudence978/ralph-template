# Progress Log - User Authentication Feature
# Auto-generated by codebase analysis on 2026-01-14
# Ralph reads this at the start of each iteration

## Codebase Patterns

### Project Type
- Language: TypeScript
- Framework: Express.js
- Package Manager: npm (lockfile: package-lock.json)
- Node Version: 20.x (from .nvmrc)

### Code Style (detected from existing files)
- Naming: camelCase for variables/functions, PascalCase for types/interfaces
- Exports: Named exports (no default exports found)
- Functions: Arrow functions preferred
- Async: async/await pattern (no .then() chains found)
- Semicolons: Yes
- Quotes: Single quotes
- Indentation: 2 spaces

### File Organization (detected from src/)
- Source root: src/
- Services: src/services/*.service.ts
- Types: src/types/*.ts
- Utils: src/utils/
- Routes: src/routes/*.routes.ts
- Controllers: src/controllers/*.controller.ts
- Middleware: src/middleware/*.ts
- Validators: src/validators/*.schema.ts
- Errors: src/errors/*.error.ts
- Tests: Co-located as *.test.ts

### Database (detected from prisma/)
- ORM: Prisma
- Database: PostgreSQL (from DATABASE_URL pattern in .env.example)
- Schema: prisma/schema.prisma
- Migrations: prisma/migrations/
- Client: @prisma/client ^5.7.0

### Testing (detected from jest.config.ts)
- Framework: Jest with ts-jest
- Config: jest.config.ts
- Coverage threshold: 80%
- Test pattern: **/*.test.ts
- Setup file: src/test/setup.ts

### Available Scripts (from package.json)
- `npm run dev` - Start development server with nodemon
- `npm run build` - Compile TypeScript to dist/
- `npm run start` - Start production server
- `npm run test` - Run Jest tests
- `npm run test:watch` - Run tests in watch mode
- `npm run test:coverage` - Run tests with coverage report
- `npm run lint` - Run ESLint
- `npm run lint:fix` - Fix ESLint issues automatically
- `npm run typecheck` - Run TypeScript compiler check (no emit)
- `npm run db:migrate` - Run Prisma migrations (dev)
- `npm run db:generate` - Generate Prisma client
- `npm run db:seed` - Seed database with test data
- `npm run db:studio` - Open Prisma Studio GUI

### Key Dependencies Already Installed
- express@^4.18.2 - Web framework
- prisma@^5.7.0 - Database ORM
- @prisma/client@^5.7.0 - Prisma runtime client
- zod@^3.22.4 - Schema validation
- bcrypt@^5.1.1 - Password hashing
- jsonwebtoken@^9.0.2 - JWT tokens
- winston@^3.11.0 - Logging
- helmet@^7.1.0 - Security headers
- cors@^2.8.5 - CORS middleware
- dotenv@^16.3.1 - Environment variables
- uuid@^9.0.0 - UUID generation

### Existing Utilities to Reuse
- src/utils/logger.ts - Winston logger instance
  - Usage: `import { logger } from '@/utils/logger'`
  - Methods: logger.info(), logger.error(), logger.warn(), logger.debug()
- src/utils/asyncHandler.ts - Async route handler wrapper
  - Usage: `router.get('/path', asyncHandler(async (req, res) => {...}))`
  - Automatically catches errors and passes to error middleware
- src/errors/AppError.ts - Base error class
  - Usage: `throw new AppError('Message', 400)`
  - Properties: message, statusCode, isOperational
- src/middleware/errorHandler.ts - Global error handler
  - Already registered in app.ts
  - Expects AppError instances for proper formatting
- src/middleware/validate.ts - Zod validation middleware
  - Usage: `router.post('/path', validate(schema), handler)`
  - Validates req.body against Zod schema

### Known Patterns from Existing Code
- All API responses use shape: `{ success: boolean, data?: T, error?: string }`
- Route files export a router, mounted in src/app.ts
- Services are classes with static methods
- Validation schemas are in src/validators/*.schema.ts
- Controllers handle HTTP, services handle business logic
- Use asyncHandler for all async route handlers
- Errors should extend AppError class

### Environment Variables (from .env.example)
- DATABASE_URL - PostgreSQL connection string
- JWT_SECRET - Secret for signing JWT tokens
- JWT_EXPIRES_IN - Token expiration (default: 7d)
- PORT - Server port (default: 3000)
- NODE_ENV - Environment (development/production/test)
- LOG_LEVEL - Winston log level (default: info)

---

## Completed Stories
[Ralph appends here as stories complete]

---

## Learnings
[Ralph adds discoveries here to avoid repeating mistakes]

---

## Blockers Encountered
[Ralph documents blocking issues here]
